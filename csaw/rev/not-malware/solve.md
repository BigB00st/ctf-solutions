# not_malware

### Tags
 * rev
 * patching 
 * angr
 
### Solution

We are given a binary that asks for a credit card number. When trying to debug the binary first, it exits because of debug checks.
(LD_PRELOAD, VMWARE, ptrace)

We nop out the function call to the debug check function, then continue analysing.

After some more analysis, I decide that angr is perfect for this challenge, as it won't take much time to find the correct input.

**Script:**
```
import angr

proj = angr.Project('./not_malware')
   
state = proj.factory.entry_state()
           
win_addr = 0x400000 + 0x1229
exit_addr = 0x400000 + 0x1110

simgr = proj.factory.simgr()
simgr.explore(find=win_addr ,avoid=exit_addr)
print(simgr.found[0].posix.dumps(0))
```

We actually get:
`b'softbank:C/5:\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00:end@\x00\x01\x00\x10\x00\x10\x00\x01\x00@\x00\x01\x00\x10\x00\x08\x00@\x00 \x00'`
as output, but we have to send only the chars up to `:end`:
`b'softbank:C/5:\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00:end'`

Then we send the string on the remote, and get the flag: **flag{th4x_f0r_ur_cr3d1t_c4rd}**
